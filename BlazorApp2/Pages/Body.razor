@page "/"
@inject HttpClient httpClient

<h1 class="pageTitle">Anime Search Engine</h1>

<div class="text-center">
    <div class="p-2">
        <input class="form-control form-control-lg w-25 mx-auto mt-4" placeholder="Anime name" @bind-value="searchName" />
    </div>
    <div class="p-2">
        <button class="btn btn-primary btn-lg" @onclick="HandleSearch">Search the Anime API</button>
    </div>
</div>

@if (query != null)
{
    <div class="container pt-3 mt-3">
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3">
            @foreach (var result in query.results)
            {
                <div class="col mb-4">
                    <div class="card h-100" style="width: 18rem;">
                        <img src="@result.image_url" class="card-img-top" style="object-fit: cover; height: 200px">
                        <div class="card-body">
                            <h5 class="card-title">@result.title</h5>
                            <div class="card-text synopsis">
                                @result.synopsis
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
}


@code {

    private string searchName;
    private RootResult query;

    private async Task HandleSearch()
    {
        query = await httpClient.GetFromJsonAsync<RootResult>($"search/anime?q={searchName}");
    }
}
